IPV4_ADDRESS_PATTERN = '''
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])
'''

IPV6_ADDRESS_PATTERN = '''
(
([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|          # 1:2:3:4:5:6:7:8
([0-9a-fA-F]{1,4}:){1,7}:|                         # 1::                              1:2:3:4:5:6:7::
([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|         # 1::8             1:2:3:4:5:6::8  1:2:3:4:5:6::8
([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|  # 1::7:8           1:2:3:4:5::7:8  1:2:3:4:5::8
([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|  # 1::6:7:8         1:2:3:4::6:7:8  1:2:3:4::8
([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|  # 1::5:6:7:8       1:2:3::5:6:7:8  1:2:3::8
([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|  # 1::4:5:6:7:8     1:2::4:5:6:7:8  1:2::8
[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|       # 1::3:4:5:6:7:8   1::3:4:5:6:7:8  1::8
:((:[0-9a-fA-F]{1,4}){1,7}|:)|                     # ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8 ::8       ::
fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|     # fe80::7:8%eth0   fe80::7:8%1     (link-local IPv6 addresses with zone index)
::(ffff(:0{1,4}){0,1}:){0,1}
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|          # ::255.255.255.255   ::ffff:255.255.255.255  ::ffff:0:255.255.255.255  (IPv4-mapped IPv6 addresses and IPv4-translated addresses)
([0-9a-fA-F]{1,4}:){1,4}:
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])           # 2001:db8:3:4::192.0.2.33  64:ff9b::192.0.2.33 (IPv4-Embedded IPv6 Address)
)
'''

IPV4_NETWORK_PATTERN = '''
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|           # 192.168.0.1
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){2,2}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|           # 192.168.0
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|           # 192.168
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])            # 192
'''

IPV6_NETWORK_PATTERN = '''
'''

# max length for domain name labels is 63 characters per RFC 1034
DOMAIN_PATTERN = '''
((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+)(?:[A-Z0-9-]{2,63}(?<!-))
'''

USERNAME_PATTERN = '''
([-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*|                 # dot-atom
"([\001-\010\013\014\016-\037!#-\[\]-\177]|\\[\001-\011\013\014\016-\177])*")   # quoted-string
'''

EMAIL_PATTERN = '%s@((%s)|(\[%s])|(\[(%s)]))' % (
    USERNAME_PATTERN,
    DOMAIN_PATTERN,
    IPV4_ADDRESS_PATTERN,
    IPV6_ADDRESS_PATTERN
)

ACTION_PATTERN = '''
(OK)|
(\d\d\d)|
(
(
4\d\d|
5\d\d|
REJECT|
DEFER|
DEFER_IF_REJECT|
DEFER_IF_PERMIT|
DISCARD|
HOLD|
INFO|
WARN
)
( .+)?
)|
(permit|reject|reject_unauth_destination)|
((BCC|REDIRECT)\s((?i)%s))|
(DUNNO)|
(FILTER\s[\w\d\_\-]+:[\w\d\_\-]+)|
(PREPEND\s[\w\d\_\-]+:\s[\w\d\_\-]+)|
''' % EMAIL_PATTERN
